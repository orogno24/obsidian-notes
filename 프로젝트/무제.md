# 🍎 과일 직판 플랫폼 요구사항 명세서 - 로그인/회원가입 기능

## SFR-001 사용자 인증 및 회원 관리 시스템

### SFR-001-01 사용자 로그인 시스템

**상세 요구사항** ○ 사용자는 ID와 비밀번호를 입력하여 로그인하며, 입력된 정보를 데이터베이스와 대조하여 인증을 처리한다. 로그인 성공 시 JWT 토큰을 발급하여 24시간 동안 유효한 사용자 세션을 관리하고, Refresh Token을 통한 자동 갱신 기능을 제공한다.

○ 로그인 실패 시 보안을 위해 구체적인 실패 사유를 노출하지 않고 일반적인 오류 메시지를 표시하며, 동일 계정에서 연속 5회 로그인 실패 시 해당 계정을 30분간 자동 잠금 처리한다.

○ 사용자 비밀번호는 BCrypt 알고리즘을 사용하여 해시화하여 데이터베이스에 저장하고, 모든 로그인 시도 이력을 기록하여 관리자가 보안 위험을 모니터링할 수 있도록 한다.

### SFR-001-02 농가 회원가입 시스템

**상세 요구사항** ○ 농가 회원가입 시 ID, 비밀번호, 농장명, 대표자명, 연락처, 이메일을 필수 입력 항목으로 하고, 농장 주소, 주요 생산 품목, 농장 소개를 선택 입력 항목으로 구성한다. ID 중복 확인은 실시간으로 처리하며, 비밀번호는 8자 이상의 영문, 숫자, 특수문자 조합을 필수로 한다.

○ 사업자등록증을 PDF, JPG, PNG 형태로 업로드하도록 하며, 각 파일의 크기는 최대 5MB로 제한한다. 업로드된 파일에 대해서는 파일 형식과 크기에 대한 유효성 검증을 실시한다.

○ 회원가입 완료 후 입력된 이메일 주소로 인증 링크를 자동 발송하며, 인증 링크는 24시간의 유효기간을 가진다. 이메일 인증이 완료되면 관리자 승인 대기 상태로 계정을 생성한다.

### SFR-001-03 소비자 회원가입 시스템

**상세 요구사항** ○ 소비자 회원가입은 ID, 비밀번호, 이름, 휴대폰 번호, 이메일을 필수 입력 항목으로 하고, 주소, 성별, 생년월일을 선택 입력 항목으로 구성한다. 농가 회원가입과 동일한 유효성 검증 규칙을 적용한다.

○ 휴대폰 번호는 000-0000-0000 형식으로 입력받아 형식 검증을 실시하고, 이메일 주소는 정규식을 통해 올바른 이메일 형식인지 확인한다.

○ 회원가입 완료 후 이메일 인증 링크를 발송하고, 인증 완료 시 별도의 관리자 승인 없이 즉시 계정을 활성화한다.

### SFR-001-04 계정 복구 기능

**상세 요구사항** ○ 사용자가 아이디를 분실한 경우 이름과 휴대폰 번호를 입력하여 아이디를 찾을 수 있으며, 보안을 위해 찾은 아이디의 일부를 마스킹하여 표시한다(예: abc***@email.com).

○ 비밀번호 재설정을 위해서는 아이디, 이름, 휴대폰 번호를 입력하여 본인 확인을 실시하고, 확인이 완료되면 임시 비밀번호를 생성하여 등록된 이메일로 발송한다.

○ 임시 비밀번호로 로그인한 사용자에게는 보안을 위해 최초 로그인 시 비밀번호 변경을 강제로 유도하는 페이지를 표시한다.

### SFR-001-05 회원 탈퇴 기능

**상세 요구사항** ○ 소비자 회원은 본인 확인 절차를 거친 후 언제든지 즉시 탈퇴 처리가 가능하며, 탈퇴 시 개인정보보호법에 따라 모든 개인정보를 데이터베이스에서 완전히 삭제한다.

○ 농가 회원의 경우 탈퇴 요청 시 미배송 주문의 존재 여부를 확인하여, 미배송 주문이 있는 경우 탈퇴를 제한하고 해당 주문 처리 완료 후 탈퇴하도록 안내 메시지를 표시한다.

○ 농가 탈퇴 조건이 충족되면 탈퇴 처리를 진행하며, 업로드된 사업자등록증 파일을 서버에서 완전히 삭제하고 관련된 모든 개인정보를 삭제한다.

### SFR-001-06 관리자 농가 승인 관리

**상세 요구사항** ○ 관리자는 전용 관리 페이지에서 미승인 농가 회원 목록을 조회할 수 있으며, 각 농가의 기본 정보와 업로드된 사업자등록증 파일을 다운로드하여 검토할 수 있다.

○ 농가 회원 검토 완료 후 승인 또는 거절 처리를 할 수 있으며, 거절하는 경우 거절 사유를 입력하도록 한다. 처리 결과는 해당 농가의 등록 이메일로 자동 통보된다.

○ 승인된 농가 회원은 즉시 로그인하여 상품 등록 등 농가 전용 기능을 이용할 수 있으며, 거절된 경우 재신청이 가능하다는 안내와 함께 거절 사유를 이메일로 발송한다.

### SFR-001-07 전체 회원 관리 시스템

**상세 요구사항** ○ 관리자는 전체 회원 목록을 조회할 수 있으며, 회원 유형별(농가/소비자), 상태별(활성/비활성/승인대기) 필터링 기능과 ID, 이름, 이메일을 통한 검색 기능을 제공한다.

○ 개별 회원의 상세 정보 조회 시 기본 정보, 가입일, 최종 로그인 일시, 주문 건수, 로그인 이력 등 활동 기록을 확인할 수 있다.

○ 문제가 있는 계정에 대해서는 계정 잠금 및 해제 기능을 제공하며, 잠금 처리 시 사유를 입력하고 해당 회원에게 이메일로 통보한다.

### 용어사전

- **JWT (JSON Web Token)**: 사용자 인증 정보를 안전하게 전송하기 위한 웹 표준 토큰
- **농가**: 과일을 직접 생산하여 판매하는 사업자 회원
- **소비자**: 과일을 구매하는 일반 개인 회원
- **사업자등록증**: 농가 회원가입 시 사업자 자격을 증명하는 필수 서류

---

## SFR-002 상품 정보 관리 및 재고 시스템

### SFR-002-01 상품 목록 조회 시스템

**상세 요구사항** ○ 모든 사용자가 등록된 과일 상품 목록을 조회할 수 있으며, 상품 목록에는 상품명, 가격, 재고 수량, 농가명, 대표 이미지가 표시된다. 페이지당 20개 상품을 기준으로 페이징 처리하여 성능 최적화를 도모한다.

○ 상품명 키워드 검색 기능을 제공하며, 가격대별 필터링(1만원 이하, 1-3만원, 3-5만원, 5만원 이상)과 농가별 필터링 기능을 구현한다.

○ 상품 정렬 기능으로 최신순, 가격 높은순, 가격 낮은순, 인기순(주문 건수 기준) 정렬을 제공하여 사용자의 다양한 검색 요구를 만족한다.

### SFR-002-02 상품 상세 조회 시스템

**상세 요구사항** ○ 상품 상세 페이지에서는 상품 기본 정보(상품명, 가격, 상세 설명, 원산지, 보관 방법), 최대 10장의 이미지 갤러리, 현재 재고 수량을 표시한다.

○ 판매자 농가 정보로 농장명, 농장 소개, 연락처를 표시하여 소비자가 농가에 대한 신뢰성을 확인할 수 있도록 한다.

○ 재고가 0개인 상품은 품절 표시를 하고 구매 버튼을 비활성화하며, 품절 상품에 대해서는 재입고 알림 신청 기능을 제공하여 재입고 시 이메일로 알림을 발송한다.

### SFR-002-03 상품 등록 시스템

**상세 요구사항** ○ 농가 회원이 새로운 상품을 등록할 수 있으며, 상품명, 가격, 수량, 상품 분류, 원산지는 필수 입력 항목으로 하고, 상세 설명, 보관 방법, 배송 정보는 선택 입력 항목으로 구성한다.

○ 상품 이미지는 JPG, PNG 형태로 각 파일 최대 2MB, 총 10장까지 업로드 가능하며, 첫 번째 이미지를 대표 이미지로 자동 설정하되 농가가 임의로 변경할 수 있다.

○ 상품 등록 시 입력 정보에 대한 유효성 검증을 실시하며, 가격은 양수, 수량은 0 이상의 정수로 제한하고 필수 항목 누락 시 오류 메시지를 표시한다.

### SFR-002-04 상품 정보 수정 시스템

**상세 요구사항** ○ 농가 회원은 본인이 등록한 상품에 한해 가격, 수량, 상세 설명, 이미지를 수정할 수 있으며, 수정할 때마다 수정 날짜와 내용을 이력으로 관리한다.

○ 상품 이미지 수정 시 기존 이미지 삭제와 새 이미지 추가가 가능하며, 대표 이미지 변경 기능을 제공한다. 삭제된 이미지 파일은 서버에서 완전히 제거한다.

○ 현재 진행 중인 주문에 포함된 상품의 경우 가격 변경을 제한하여 주문 무결성을 보장하고, 재고 수량 변경 시 음수가 되지 않도록 제한한다.

### SFR-002-05 상품 삭제 및 상태 관리

**상세 요구사항** ○ 농가 회원은 본인이 등록한 상품을 삭제할 수 있으나, 현재 진행 중인 주문이 있는 경우 삭제를 제한하고 안내 메시지를 표시한다.

○ 상품 삭제 시 재확인 절차를 거친 후 상품 정보와 관련된 모든 이미지 파일을 서버에서 완전히 삭제한다.

○ 농가는 상품의 판매 상태를 "판매 중" 또는 "판매 중지"로 설정할 수 있으며, 판매 중지된 상품은 목록에서 노출되지 않고 기존 장바구니에 담긴 경우 주문 시 자동으로 제외 처리된다.

### SFR-002-06 재고 관리 시스템

**상세 요구사항** ○ 주문이 확정되는 시점에 해당 상품의 재고를 자동으로 차감하며, 동시에 여러 사용자가 같은 상품을 주문할 경우 트랜잭션 처리를 통해 재고 부족이 발생하지 않도록 데이터 일관성을 보장한다.

○ 주문 취소 시에는 차감된 재고를 자동으로 복원하고, 이러한 재고 변동 이력을 모두 기록하여 농가가 재고 관리 현황을 확인할 수 있도록 한다.

○ 농가가 설정한 기준(기본값: 재고 5개 이하) 이하로 재고가 감소하면 이메일로 알림을 발송하고, 재고가 0개가 되면 자동으로 품절 상태로 전환하여 추가 주문을 방지한다.

### 용어사전

- **상품**: 농가가 판매하는 과일 및 농산물
- **재고**: 판매 가능한 상품의 수량
- **판매 상태**: 상품의 노출 여부를 결정하는 상태값
- **품절**: 재고가 0개인 상태로 주문이 불가능한 상품

---

## SFR-003 주문 처리 및 이력 관리 시스템

### SFR-003-01 장바구니 관리 시스템

**상세 요구사항** ○ 로그인한 소비자는 원하는 상품을 장바구니에 담을 수 있으며, 상품별 수량 조정이 가능하되 해당 상품의 재고 한도를 초과할 수 없도록 실시간 검증한다.

○ 장바구니에 담긴 상품의 총 금액을 실시간으로 계산하여 표시하고, 상품 가격 변경이나 품절 시 장바구니 내용을 자동으로 업데이트한다.

○ 장바구니 내용은 사용자별로 데이터베이스에 저장되어 로그아웃 후 재로그인 시에도 유지되며, 30일 이상 미접속 시 자동으로 삭제된다.

### SFR-003-02 주문 생성 시스템

**상세 요구사항** ○ 소비자는 장바구니에서 원하는 상품을 선택하여 주문을 생성할 수 있으며, 주문 생성 과정에서 배송지 정보(수령인명, 주소, 연락처, 배송 요청사항)를 입력받는다.

○ 결제 방법은 신용카드, 계좌이체, 무통장입금 중 선택할 수 있으며, 주문자 정보는 로그인된 회원 정보를 기반으로 자동 입력된다.

○ 주문 생성 전 선택한 상품의 재고 수량을 재확인하고, 판매 중지된 상품이 포함된 경우 자동으로 제외 처리하며, 주문 성공 시 YYYYMMDDHHMMSS 형식의 고유 주문 번호를 발급한다.

### SFR-003-03 주문 수정 및 취소 시스템

**상세 요구사항** ○ READY 상태의 주문에 한해서만 주문 내용을 수정할 수 있으며, 상품별 수량 변경 시 재고 한도 내에서 증량은 가능하고 감량은 자유롭게 할 수 있다.

○ 배송지 정보도 READY 상태일 때만 변경 가능하며, 수정 시마다 총 주문 금액을 재계산하여 표시한다.

○ 주문 취소는 READY 상태일 때만 가능하며, 취소 사유를 선택(단순 변심, 상품 불만족, 배송지 변경, 기타)하도록 하고 재확인 팝업을 통해 실수로 인한 취소를 방지한다.

### SFR-003-04 주문 내역 조회 시스템

**상세 요구사항** ○ 로그인한 사용자는 자신의 모든 주문 내역을 조회할 수 있으며, 주문 상태별(전체, 주문접수, 배송준비, 배송중, 배송완료, 취소) 및 기간별(1개월, 3개월, 6개월, 1년, 전체) 필터링 기능을 제공한다.

○ 주문 목록에서는 주문번호, 주문일자, 대표 상품명(외 N건), 총 주문금액, 현재 주문 상태를 표시하고, 각 주문을 클릭하면 상세 페이지로 이동한다.

○ 주문 상세 페이지에서는 주문 기본 정보, 주문 상품 상세 정보, 배송 정보, 결제 정보를 확인할 수 있으며, 주문번호, 상품명, 농가명을 통한 검색 기능을 제공한다.

### SFR-003-05 주문 상태 관리 시스템

**상세 요구사항** ○ 주문 상태는 READY(주문접수) → PROCESSING(처리중) → SHIPPED(배송중) → DELIVERED(배송완료) → CANCELLED(취소) 순으로 관리되며, 각 상태 변경 시점을 자동으로 기록한다.

○ 주문 상태에 따라 적절한 액션 버튼을 제공하며, READY 상태에서는 수정 및 취소 버튼을, 배송완료 상태에서는 수령확인 및 리뷰작성 버튼을 표시한다.

○ 모든 주문 변경 사항(수정/취소)은 변경 시점, 변경 내용, 변경 사유와 함께 이력으로 관리하여 고객 서비스 및 분쟁 해결 시 활용할 수 있도록 한다.

### 용어사전

- **장바구니**: 구매 예정 상품을 임시로 보관하는 가상 공간
- **주문 상태**: 주문의 처리 단계를 나타내는 상태값
- **주문 내역**: 사용자가 과거에 생성한 모든 주문의 기록
- **배송지**: 주문한 상품이 배송될 목적지 주소

---

## SFR-004 배송 추적 시스템 및 품질 보증 테스트

### SFR-004-01 배송 상태 초기화 및 전이 시스템

**상세 요구사항** ○ 주문이 성공적으로 생성되면 해당 주문의 배송 상태를 자동으로 READY(배송준비)로 초기화하고, 각 상태 변경 시점마다 자동으로 타임스탬프를 기록한다.

○ 배송 상태는 READY(배송준비) → ON_ROUTE(배송중) → DELIVERED(배송완료) 순서로 전이되며, 상태 역행을 방지하는 로직을 구현한다.

○ 배송 상태가 변경될 때마다 고객에게 이메일 알림을 자동 발송하며, 고객이 선택한 경우 SMS 알림도 함께 제공한다.

### SFR-004-02 배송 추적 및 조회 시스템

**상세 요구사항** ○ 주요 택배업체(CJ대한통운, 롯데택배, 한진택배 등)의 API와 연동하여 실시간 배송 추적 정보를 업데이트하고, 택배업체 송장번호와 공식 추적 페이지 링크를 제공한다.

○ 사용자는 주문 상세 페이지에서 현재 배송 상태를 시각적인 프로그레스 바로 확인할 수 있고, 배송 단계별 예상 소요시간을 안내받는다.

○ 배송 완료 시 고객이 직접 수령 확인을 할 수 있는 기능을 제공하되, 수령 확인이 없는 경우 배송 완료 후 72시간이 지나면 자동으로 최종 완료 처리한다.

### SFR-004-03 단위 테스트 시스템

**상세 요구사항** ○ 플랫폼의 각 모듈별 독립적 기능을 검증하기 위한 자동화된 단위 테스트 환경을 구축하며, 회원 관리, 상품 관리, 주문 처리, 배송 관리 모듈의 핵심 기능에 대한 테스트 케이스를 작성한다.

○ 테스트 커버리지 80% 이상을 목표로 하며, 각 테스트는 독립적으로 실행되어 다른 테스트의 영향을 받지 않도록 모킹(Mocking) 기법을 활용한다.

○ 테스트 실행 결과는 자동으로 기록되어 보관되며, 테스트 실패 시 즉시 개발팀에 알림을 발송하고, CI/CD 파이프라인과 연동하여 코드 배포 전 자동으로 실행된다.

### SFR-004-04 통합 테스트 시스템

**상세 요구사항** ○ 전체 시스템의 비즈니스 프로세스를 종합적으로 검증하기 위한 End-to-End 통합 테스트를 구현하며, 소비자의 전체 구매 프로세스와 농가의 전체 판매 프로세스를 자동화된 시나리오로 검증한다.

○ 동시 사용자 환경에서의 시스템 안정성을 확인하기 위해 같은 상품에 대한 동시 주문 상황에서 재고 관리의 정확성을 검증하고, 부하 테스트를 통해 시스템 성능을 측정한다.

○ 모든 테스트 결과는 상세한 로그와 함께 데이터베이스에 저장되며, 주기적으로 테스트 보고서를 생성하여 관련 팀에 배포하고, 버그 발견 시 이슈 트래킹 시스템과 연동한다.

### 용어사전

- **배송 상태**: 주문 상품의 배송 진행 단계
- **단위 테스트**: 개별 모듈이나 함수의 기능을 독립적으로 검증하는 테스트
- **통합 테스트**: 여러 모듈 간의 연동과 전체 워크플로우를 검증하는 테스트
- **End-to-End 테스트**: 사용자 관점에서 전체 시스템 기능을 검증하는 테스트