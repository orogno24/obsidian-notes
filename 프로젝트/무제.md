# 🍎 과일 직판 플랫폼 요구사항 명세서 - 로그인/회원가입 기능

## SFR-001 사용자 인증 및 회원 관리 시스템

### SFR-001-01 사용자 로그인 시스템

**상세 요구사항** ○ 사용자는 ID와 비밀번호를 입력하여 로그인하며, 입력된 정보를 데이터베이스와 대조하여 인증을 처리한다. 로그인 성공 시 JWT 토큰을 발급하여 24시간 동안 유효한 사용자 세션을 관리하고, Refresh Token을 통한 자동 갱신 기능을 제공한다.

○ 로그인 실패 시 보안을 위해 구체적인 실패 사유를 노출하지 않고 일반적인 오류 메시지를 표시하며, 동일 계정에서 연속 5회 로그인 실패 시 해당 계정을 30분간 자동 잠금 처리한다.

○ 사용자 비밀번호는 BCrypt 알고리즘을 사용하여 해시화하여 데이터베이스에 저장하고, 모든 로그인 시도 이력을 기록하여 관리자가 보안 위험을 모니터링할 수 있도록 한다.

### SFR-001-02 농가 회원가입 시스템

**상세 요구사항** ○ 농가 회원가입 시 ID, 비밀번호, 농장명, 대표자명, 연락처, 이메일을 필수 입력 항목으로 하고, 농장 주소, 주요 생산 품목, 농장 소개를 선택 입력 항목으로 구성한다. ID 중복 확인은 실시간으로 처리하며, 비밀번호는 8자 이상의 영문, 숫자, 특수문자 조합을 필수로 한다.

○ 사업자등록증을 PDF, JPG, PNG 형태로 업로드하도록 하며, 각 파일의 크기는 최대 5MB로 제한한다. 업로드된 파일에 대해서는 파일 형식과 크기에 대한 유효성 검증을 실시한다.

○ 회원가입 완료 후 입력된 이메일 주소로 인증 링크를 자동 발송하며, 인증 링크는 24시간의 유효기간을 가진다. 이메일 인증이 완료되면 관리자 승인 대기 상태로 계정을 생성한다.

### SFR-001-03 소비자 회원가입 시스템

**상세 요구사항** ○ 소비자 회원가입은 ID, 비밀번호, 이름, 휴대폰 번호, 이메일을 필수 입력 항목으로 하고, 주소, 성별, 생년월일을 선택 입력 항목으로 구성한다. 농가 회원가입과 동일한 유효성 검증 규칙을 적용한다.

○ 휴대폰 번호는 000-0000-0000 형식으로 입력받아 형식 검증을 실시하고, 이메일 주소는 정규식을 통해 올바른 이메일 형식인지 확인한다.

○ 회원가입 완료 후 이메일 인증 링크를 발송하고, 인증 완료 시 별도의 관리자 승인 없이 즉시 계정을 활성화한다.

### SFR-001-04 계정 복구 기능

**상세 요구사항** ○ 사용자가 아이디를 분실한 경우 이름과 휴대폰 번호를 입력하여 아이디를 찾을 수 있으며, 보안을 위해 찾은 아이디의 일부를 마스킹하여 표시한다(예: abc***@email.com).

○ 비밀번호 재설정을 위해서는 아이디, 이름, 휴대폰 번호를 입력하여 본인 확인을 실시하고, 확인이 완료되면 임시 비밀번호를 생성하여 등록된 이메일로 발송한다.

○ 임시 비밀번호로 로그인한 사용자에게는 보안을 위해 최초 로그인 시 비밀번호 변경을 강제로 유도하는 페이지를 표시한다.

### SFR-001-05 회원 탈퇴 기능

**상세 요구사항** ○ 소비자 회원은 본인 확인 절차를 거친 후 언제든지 즉시 탈퇴 처리가 가능하며, 탈퇴 시 개인정보보호법에 따라 모든 개인정보를 데이터베이스에서 완전히 삭제한다.

○ 농가 회원의 경우 탈퇴 요청 시 미배송 주문의 존재 여부를 확인하여, 미배송 주문이 있는 경우 탈퇴를 제한하고 해당 주문 처리 완료 후 탈퇴하도록 안내 메시지를 표시한다.

○ 농가 탈퇴 조건이 충족되면 탈퇴 처리를 진행하며, 업로드된 사업자등록증 파일을 서버에서 완전히 삭제하고 관련된 모든 개인정보를 삭제한다.

### SFR-001-06 관리자 농가 승인 관리

**상세 요구사항** ○ 관리자는 전용 관리 페이지에서 미승인 농가 회원 목록을 조회할 수 있으며, 각 농가의 기본 정보와 업로드된 사업자등록증 파일을 다운로드하여 검토할 수 있다.

○ 농가 회원 검토 완료 후 승인 또는 거절 처리를 할 수 있으며, 거절하는 경우 거절 사유를 입력하도록 한다. 처리 결과는 해당 농가의 등록 이메일로 자동 통보된다.

○ 승인된 농가 회원은 즉시 로그인하여 상품 등록 등 농가 전용 기능을 이용할 수 있으며, 거절된 경우 재신청이 가능하다는 안내와 함께 거절 사유를 이메일로 발송한다.

### SFR-001-07 전체 회원 관리 시스템

**상세 요구사항** ○ 관리자는 전체 회원 목록을 조회할 수 있으며, 회원 유형별(농가/소비자), 상태별(활성/비활성/승인대기) 필터링 기능과 ID, 이름, 이메일을 통한 검색 기능을 제공한다.

○ 개별 회원의 상세 정보 조회 시 기본 정보, 가입일, 최종 로그인 일시, 주문 건수, 로그인 이력 등 활동 기록을 확인할 수 있다.

○ 문제가 있는 계정에 대해서는 계정 잠금 및 해제 기능을 제공하며, 잠금 처리 시 사유를 입력하고 해당 회원에게 이메일로 통보한다.

### 용어사전

- **JWT (JSON Web Token)**: 사용자 인증 정보를 안전하게 전송하기 위한 웹 표준 토큰
- **농가**: 과일을 직접 생산하여 판매하는 사업자 회원
- **소비자**: 과일을 구매하는 일반 개인 회원
- **사업자등록증**: 농가 회원가입 시 사업자 자격을 증명하는 필수 서류