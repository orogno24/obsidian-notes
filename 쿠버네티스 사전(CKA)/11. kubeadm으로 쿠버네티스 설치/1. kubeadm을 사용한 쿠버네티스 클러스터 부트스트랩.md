## kubeadm 소개

- **kubeadm이란?** 쿠버네티스 모범 사례를 사용하여 다중 노드 클러스터를 설정하는 도구
- **주요 기능**:
    - 여러 컴포넌트(kube-apiserver, etcd, 컨트롤러 등)의 설치 자동화
    - 보안 및 인증서 구성 자동화
    - 여러 노드에 걸친 컴포넌트 간 통신 설정 간소화

## kubeadm을 사용한 클러스터 설정 단계

### 1. 시스템 준비

- 여러 시스템 또는 VM 프로비저닝
- 물리적 머신 또는 가상 머신 사용 가능
- 하나의 노드를 마스터로, 나머지를 워커 노드로 지정

### 2. 컨테이너 런타임 설치

- 모든 노드에 컨테이너 런타임 설치 필요
- 예제에서는 containerd 사용

### 3. kubeadm 도구 설치

- 모든 노드에 kubeadm 도구 설치
- 쿠버네티스 구성 요소의 올바른 설치 및 구성 지원

### 4. 마스터 서버 초기화

- 필요한 모든 컴포넌트가 마스터 서버에 설치 및 구성됨

### 5. 네트워크 사전 요구 사항 충족

- 일반 네트워크 연결만으로는 불충분
- 마스터와 워커 노드 간 Pod 네트워크 구성 필요

### 6. 워커 노드 연결

- 워커 노드를 마스터 노드에 연결

### 7. 애플리케이션 배포

- 구성된 쿠버네티스 환경에 애플리케이션 배포

## 로컬 환경에서 클러스터 구축 데모

### 사용 도구

1. **VirtualBox**
    - 하이퍼바이저로서 가상 머신 실행 담당
    - virtualbox.org에서 다운로드 가능

2. **Vagrant**
    - VM 자동화 도구
    - 특정 구성으로 여러 VM을 쉽게 프로비저닝
    - 단일 명령어로 동일한 VM 구성 생성 가능

### 필수 사전 요구사항

- VirtualBox 설치
- Vagrant 설치
- 코스 리포지토리 클론 (Vagrant 파일 포함)

### Vagrant 파일 구성

- 1개의 마스터 노드와 2개의 워커 노드 구성
- IP 주소는 192.168.56 네트워크 사용
- VM 구성에 필요한 모든 설정 포함

### VM 프로비저닝 과정

1. `vagrant status` 명령으로 VM 상태 확인
2. `vagrant up` 명령으로 모든 VM 프로비저닝
    - Ubuntu Bionic 64 베이스 이미지 사용
    - 마스터 노드와 워커 노드 순차적 프로비저닝
3. VM 프로비저닝 완료 후 다시 `vagrant status`로 확인
    - 모든 노드가 running 상태인지 확인

### VM 접속 방법

- `vagrant ssh <노드_이름>` 명령으로 특정 노드에 접속
    - 예: `vagrant ssh kubemaster`
    - 예: `vagrant ssh kubenode01`
    - 예: `vagrant ssh kubenode02`
- `logout` 명령으로 세션 종료

## 추가 참고사항

- kubeadm은 쿠버네티스 클러스터 설정의 복잡성을 크게 줄여줌
- 수동으로 모든 컴포넌트를 설치하고 구성하는 것보다 훨씬 효율적
- 로컬 환경에서의 실습을 통해 실제 프로덕션 환경 구성 방법 이해 가능
- VirtualBox와 Vagrant의 조합으로 쉽게 테스트 환경 구축 가능
- 모든 노드에서 동일한 구성을 사용하여 일관된 환경 유지