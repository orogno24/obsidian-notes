## 네트워크란 무엇인가?

### 기본 네트워크 구성

- **네트워크**: 서로 통신할 수 있는 컴퓨터들의 집합
- **스위치**: 같은 네트워크 내에서 컴퓨터들을 연결해주는 장치
- **인터페이스**: 컴퓨터가 네트워크에 연결되는 지점 (예: 랜카드)

### 간단한 네트워크 예시

1. 컴퓨터 A와 B가 있음
2. 두 컴퓨터를 스위치에 연결
3. 각 컴퓨터에 같은 네트워크 대역의 IP 주소 할당
    - 컴퓨터 A: 192.168.1.10
    - 컴퓨터 B: 192.168.1.11
4. 이제 두 컴퓨터는 서로 통신 가능!

### 리눅스에서 네트워크 인터페이스 확인

```bash
# 네트워크 인터페이스 목록 보기
ip link

# 인터페이스에 할당된 IP 주소 확인
ip addr
```

## 라우터와 게이트웨이

### 서로 다른 네트워크 연결하기

- **문제**: 다른 네트워크의 컴퓨터와 통신하려면?
- **해결책**: 라우터 사용!

### 라우터란?

- 서로 다른 네트워크를 연결해주는 장치
- 여러 네트워크 인터페이스를 가짐
- 각 네트워크에 하나씩 IP 주소를 가짐

### 게이트웨이란?

- 다른 네트워크로 나가는 '문'
- 컴퓨터가 자신의 네트워크 밖으로 나갈 때 통과하는 지점
- 보통 라우터의 IP 주소를 게이트웨이로 설정

#### 쉬운 비유

- 네트워크 = 방
- 게이트웨이 = 방에서 밖으로 나가는 문
- 컴퓨터가 다른 방(네트워크)으로 가려면 문(게이트웨이)을 통과해야 함

### 라우팅 테이블

- 어떤 네트워크로 가려면 어떤 게이트웨이를 통과해야 하는지 알려주는 표
- 리눅스에서 확인:

```bash
# 라우팅 테이블 확인
route
# 또는
ip route
```

### 라우팅 설정 예시

```bash
# 192.168.2.0 네트워크로 가려면 192.168.1.1 게이트웨이를 통해 가라
ip route add 192.168.2.0/24 via 192.168.1.1
```

### 기본 게이트웨이 설정

- 특정 경로가 없는 모든 트래픽에 대한 기본 통로
- 인터넷으로 나가는 문과 같음

```bash
# 모든 미지정 트래픽은 192.168.1.1로 보내라
ip route add default via 192.168.1.1
# 또는
ip route add 0.0.0.0/0 via 192.168.1.1
```

## 리눅스를 라우터로 사용하기

### 간단한 네트워크 구성 예시

- 컴퓨터 A: 네트워크 1 (192.168.1.5)
- 컴퓨터 B: 네트워크 1과 2에 모두 연결 (192.168.1.6, 192.168.2.6)
- 컴퓨터 C: 네트워크 2 (192.168.2.5)

### 라우팅 설정

1. A에서 C로 가는 경로 설정

```bash
# A에서 실행: C가 있는 네트워크로 가려면 B를 통해 가라
ip route add 192.168.2.0/24 via 192.168.1.6
```

2. C에서 A로 가는 경로 설정

```bash
# C에서 실행: A가 있는 네트워크로 가려면 B를 통해 가라
ip route add 192.168.1.0/24 via 192.168.2.6
```

### IP 포워딩 활성화

- 기본적으로 리눅스는 한 네트워크에서 받은 패킷을 다른 네트워크로 전달하지 않음
- 라우터 역할을 하려면 IP 포워딩을 활성화해야 함

```bash
# B 컴퓨터에서 IP 포워딩 활성화
echo 1 > /proc/sys/net/ipv4/ip_forward

# 재부팅 후에도 유지하려면
echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf
sysctl -p
```

## 주요 명령어 정리

### 네트워크 인터페이스 관련

```bash
# 인터페이스 목록 확인
ip link

# IP 주소 확인
ip addr

# IP 주소 추가
ip addr add 192.168.1.10/24 dev eth0
```

### 라우팅 관련

```bash
# 라우팅 테이블 확인
route
# 또는
ip route

# 라우트 추가
ip route add 192.168.2.0/24 via 192.168.1.1

# 기본 게이트웨이 설정
ip route add default via 192.168.1.1
```

### IP 포워딩 관련

```bash
# IP 포워딩 상태 확인
cat /proc/sys/net/ipv4/ip_forward

# IP 포워딩 활성화
echo 1 > /proc/sys/net/ipv4/ip_forward
```

## 설정 유지하기

### 일시적 설정 vs 영구적 설정

- 위 명령어로 변경한 설정은 **재부팅 시 사라짐**
- 영구적으로 유지하려면:
    - 네트워크 설정: `/etc/network/interfaces` 파일 수정
    - IP 포워딩: `/etc/sysctl.conf` 파일 수정