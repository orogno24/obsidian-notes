
1. 프론트엔드 프로젝트의 js
    async function connect() {  
        const name = document.getElementById('name').value.trim();  
        const msgElement = document.getElementById('msg');  
  
        // 입력 검증  
        if (!name) {  
            alert('이름을 입력하세요!');  
            document.getElementById('name').focus();  
            return;  
        }  
  
        // 로딩 상태 표시  
        msgElement.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>처리 중...';  
        msgElement.style.color = '#6c757d';  
  
        // 요청 시작 시간 기록  
        const startTime = performance.now();  
  
        try {  
            const res = await fetch(`/api/frontend/${encodeURIComponent(name)}`);  
  
            if (!res.ok) {  
                throw new Error(`HTTP 오류: ${res.status}`);  
            }  
  
            const json = await res.json();  
  
            // 성공 메시지 표시  
            msgElement.innerHTML = `<i class="fas fa-check-circle me-2"></i>${json.message}`;  
            msgElement.style.color = '#28a745';  
  
            // 요청 소요 시간 콘솔에 기록 (개발용)  
            console.log(`API 요청 소요 시간: ${Math.round(performance.now() - startTime)}ms`);  
  
            // 성공 시 추가 동작 (예: 페이지 이동)  
            setTimeout(() => {  
                // window.location.href = '/shop'; // 원하는 페이지로 이동  
            }, 2000);  
  
        } catch (error) {  
            console.error('API 요청 오류:', error);  
            msgElement.innerHTML = `<i class="fas fa-exclamation-triangle me-2"></i>오류: ${error.message}`;  
            msgElement.style.color = '#dc3545';  
        }  
    }  
  
    // 엔터키로 접속하기  
    document.getElementById('name').addEventListener('keypress', function(e) {  
        if (e.key === 'Enter') {  
            connect();  
        }  
    });  
  
    // 페이지 로드 시 이름 입력창에 포커스  
    window.addEventListener('load', function() {  
        // 스피너 숨기기  
        setTimeout(() => {  
            document.getElementById('spinner').classList.remove('show');  
            document.getElementById('name').focus();  
        }, 500);  
    });

2. 프론트엔드 프로젝트의 컨트롤러 

package com.example.frontapp.controller;  
  
import com.example.frontapp.service.impl.FrontendService;  
import lombok.RequiredArgsConstructor;  
import org.springframework.web.bind.annotation.GetMapping;  
import org.springframework.web.bind.annotation.PathVariable;  
import org.springframework.web.bind.annotation.RequestMapping;  
import org.springframework.web.bind.annotation.RestController;  
  
import java.util.Map;  
  
@RequiredArgsConstructor  
@RestController  
@RequestMapping("/api")  
public class GreetingController {  
  
    private final FrontendService frontendService;  
  
    @GetMapping("/frontend/{name}")  
    public Map<String, String> greet(@PathVariable String name) {  
        String msg = frontendService.callBackend(name);  
        return Map.of("message", msg);  
    }  
  
}


3. 프론트엔드 프로젝트의 서비스 


package com.example.frontapp.service.impl;  
  
import com.example.frontapp.service.IFrontendService;  
import lombok.RequiredArgsConstructor;  
import org.springframework.stereotype.Service;  
import org.springframework.web.client.RestTemplate;  
  
import java.util.Map;  
  
@Service  
@RequiredArgsConstructor  
public class FrontendService implements IFrontendService {  
    private final RestTemplate rt;  
  
    @Override  
    public String callBackend(String name) {  
        Map<?, ?> resp = rt.getForObject(  
                "http://backend-service:8090/api/backend/" + name,  
                Map.class);  
  
        return (String) resp.get("message");  
    }  
}

4. 게이트웨이 프로젝트 설정

server:  
  port: 12000  # 프론트엔드에서 예상하는 포트  
  
spring:  
  cloud:  
    gateway:  
      routes:  
        - id: backend  
          uri: http://backend-service:8090  # 백엔드 서비스 주소  
          predicates:  
            - Path=/api/backend/**  # 백엔드 API 경로  
        - id: frontend-api  
          uri: http://backend-service:8090  # 백엔드 서비스 주소  
          predicates:  
            - Path=/api/frontend/**  # 프론트엔드에서 요청하는 경로  
          filters:  
            - RewritePath=/api/frontend/(?<segment>.*), /api/backend/${segment}  # 경로 재작성  
      globalcors:  
        corsConfigurations:  
          '[/**]':  
            allowed-origins:  
              - "http://localhost:8080"  
              - "http://front.dev.gcp.go.kr:30999"  
              - "https://api.dev.eris.go.kr"  
            allowed-methods: "*"  
            allowed-headers: "*"  
            allow-credentials: true

5. 백엔드 프로젝트 컨트롤러
package com.example.backendapp.controller;  
  
import com.example.backendapp.repository.UserRepository;  
import com.example.backendapp.repository.entity.User;  
import lombok.RequiredArgsConstructor;  
import lombok.extern.slf4j.Slf4j;  
import org.springframework.web.bind.annotation.GetMapping;  
import org.springframework.web.bind.annotation.PathVariable;  
import org.springframework.web.bind.annotation.RequestMapping;  
import org.springframework.web.bind.annotation.RestController;  
  
import java.util.Map;  
  
@Slf4j  
@RestController  
@RequestMapping("/api")  
@RequiredArgsConstructor  
public class GreetingController {  
    private final UserRepository userRepository;  
  
    @GetMapping("/backend/{name}")  
    public Map<String, String> backend(@PathVariable String name) {  
        log.info("API 호출 시작: /api/backend/{} 요청 받음", name);  
  
        // DB에서 사용자 이름 조회  
        boolean userExists = userRepository.existsByName(name);  
  
        if (userExists) {  
            // 이미 등록된 사용자인 경우  
            log.info("이미 등록된 사용자: {}", name);  
            String message = name + "님은 이미 등록된 사용자입니다.";  
            log.info("응답 메시지 생성: {}", message);  
            log.info("API 호출 종료: /api/backend/{} 응답 완료", name);  
            return Map.of("message", message);  
        } else {  
            // 새로운 사용자인 경우, DB에 저장  
            User newUser = new User();  
            newUser.setName(name);  
            userRepository.save(newUser);  
  
            log.info("새 사용자 등록 완료: {}", name);  
            String message = name + "님이 등록되었습니다.";  
            log.info("응답 메시지 생성: {}", message);  
            log.info("API 호출 종료: /api/backend/{} 응답 완료", name);  
            return Map.of("message", message);  
        }  
    }  
}