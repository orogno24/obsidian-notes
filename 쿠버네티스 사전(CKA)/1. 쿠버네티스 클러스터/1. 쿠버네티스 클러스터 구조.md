![[쿠버네티스 구조.PNG.png]]
## 1. 마스터 노드와 워커 노드

### 마스터 노드

- 선단의 지휘 본부인 "작업 관리 선박"
- 전체 선단의 운영을 책임지며, 워커 노드들에게 지시를 내리고 작업을 할당
### 워커 노드

- 실제로 컨테이너(화물)를 싣고 운반하는 "운송 선박"
- 마스터 노드의 지시에 따라 움직이며, 각자의 역할을 수행
### Kubelet

- 각 워커 노드에 있는 선장
- 마스터 노드의 kube-apiserver로부터 kube-scheduler의 결정에 근거하여 HTTP 엔드포인트를 통해 로드할 포드에 대한 지시를 받음
- 자신의 선박인 워커 노드를 독립적으로 관리
- 쿠버네티스 클러스터의 유일한 연락처

## 2. 마스터 노드의 구성 요소

### kube-apiserver (통신 본부)

- **역할**: 마스터 노드의 핵심 통신 허브
- 외부의 명령을 받아들이고 워커 노드와의 통신을 담당
- etcd 클러스터와 직접 상호 작용하는 유일한 구성 요소
- 스케줄러, 컨트롤러 매니저 및 kubelet과 같은 구성 요소는 apiserver를 사용하여 클러스터에서 업데이트
- **비유**: 선단 전체의 명령과 통신이 이루어지는 "통신 본부"

### etcd 클러스터 (중앙 데이터 저장소)

- **역할**: 클러스터의 상태 정보와 설정을 저장하는 분산 키-값 저장소
- 파드, Configs, Secrets 등 클러스터에 관한 정보를 저장
- 모든 정보는 kubectl get을 통해 확인 가능
- **비유**: 선단의 모든 중요한 정보와 항해 기록을 보관하는 "중앙 데이터 저장소"

### kube-scheduler (작업 배치 관리자)

- **역할**: 새로운 컨테이너 생성 요청이 들어오면, 이를 어느 워커 노드에 배치할지 결정
- **비유**: 각 운송 선박의 적재량(리소스)과 상태를 고려하여 화물을 적절히 배분하는 "작업 배치 관리자"

### controller-manager (자동화 관리 감독관)

- **역할**: 클러스터의 실제 상태를 원하는 상태로 유지하기 위해 다양한 컨트롤러를 실행
- **비유**: 선단의 운항이 계획대로 진행되도록 감시하고 조정하는 "자동화 관리 감독관"
- **구성요소**:
    - **노드 컨트롤러**: 노드 상태를 모니터링하고 애플리케이션을 계속 실행하기 위해 필요한 조치
    - **복제 컨트롤러**: 레플리카셋의 상태를 모니터링하고 항상 원하는 수의 포드를 사용할 수 있도록 보장
    - 이 외에도 다양한 컨트롤러가 존재

## 3. 워커 노드의 구성 요소

### kube-proxy (네트워크 관리 담당자)

- **역할**: 클러스터 내에서 모든 포드는 다른 모든 포드에 도달 가능
- 포드 네트워킹 클러스터를 배포함으로써 가능
- 각 노드에서 네트워크 프록시 역할을 수행하여 서비스 간 통신을 지원
- 각 노드에 존재해야 하기 때문에 데몬셋으로 배포 가능
- **비유**: 선박 간의 통신과 네트워크를 관리하는 "네트워크 관리 담당자"

### Docker/컨테이너 런타임 엔진 (화물 적재 및 실행 시스템)

- **역할**: 컨테이너를 실제로 실행시키는 소프트웨어
- 애플리케이션을 격리된 환경에서 실행
- **비유**: 화물을 선박에 적재하고 관리하는 "화물 적재 및 실행 시스템"

## 4. 전체적인 흐름

### 마스터 노드의 역할

- 작업 관리 선박인 마스터 노드는 통신 본부(kube-apiserver)를 통해 명령을 전달
- 중앙 데이터 저장소(etcd)에 정보를 저장
- 작업 배치 관리자(kube-scheduler)를 통해 작업을 효율적으로 분배
- 자동화 관리 감독관(controller-manager)을 통해 선단의 상태를 유지

### 워커 노드의 역할

- 운송 선박인 워커 노드는 선장(kubelet)의 지휘 아래 화물 적재 시스템(Docker/컨테이너 런타임 엔진)을 이용하여 컨테이너를 실행
- 네트워크 관리 담당자(kube-proxy)를 통해 다른 선박과의 통신을 원활하게 함