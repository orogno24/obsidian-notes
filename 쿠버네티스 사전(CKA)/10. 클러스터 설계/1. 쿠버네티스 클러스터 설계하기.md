## 클러스터 설계 시 고려사항

### 기본 고려사항

- **목적**: 학습, 개발, 테스트, 또는 프로덕션용?
- **클라우드 사용 여부**: 클라우드 관리형 또는 자체 호스팅?
- **워크로드 유형**: 어떤 종류의 애플리케이션을 실행할 예정인가?
- **애플리케이션 수**: 소수 또는 다수?
- **애플리케이션 유형**: 웹 앱, 빅데이터, 분석 등?
- **네트워크 트래픽 패턴**: 지속적인 높은 트래픽 또는 버스트성?

### 목적별 설계 방향

#### 학습용 클러스터

- **추천 구성**: 미니큐브(Minikube) 또는 단일 노드 kubeadm 클러스터
- **배포 위치**: 로컬 VM 또는 클라우드(GCP, AWS 등)
- **특징**: 간단한 설정, 리소스 요구사항 낮음

#### 개발 및 테스트용 클러스터

- **추천 구성**: 단일 마스터, 다중 워커 노드 클러스터
- **배포 도구**: kubeadm 또는 클라우드 관리형 서비스(GKE, EKS, AKS)
- **특징**: 실제 환경과 유사하게 구성 가능하나 HA 설정 없음

#### 프로덕션용 클러스터

- **추천 구성**: 고가용성(HA) 다중 마스터, 다중 워커 노드 클러스터
- **배포 도구**: kubeadm, kOps(AWS용), 또는 클라우드 관리형 서비스
- **클러스터 한계**:
    - 최대 5,000개 노드
    - 최대 150,000개 파드
    - 최대 300,000개 컨테이너
    - 노드당 최대 100개 파드

### 노드 리소스 요구사항

- 클러스터 크기에 따라 노드 리소스 요구사항 달라짐
- 클라우드 서비스 제공업체는 클러스터 크기에 따라 적절한 인스턴스 크기 자동 선택
- 온프레미스 배포 시 클라우드 서비스 제공업체 권장사항 참조 가능

## 배포 옵션

### 온프레미스 배포

- **kubeadm**: 가장 유용한 도구, 수동 설정 필요
- **OpenShift**: Red Hat의 엔터프라이즈급 쿠버네티스 플랫폼
- **Cloud Foundry Container Runtime**: BOSH 도구를 통한 HA 클러스터 배포
- **VMware Cloud PKS**: VMware 환경용 쿠버네티스 솔루션
- **Vagrant**: 다양한 클라우드 서비스 제공업체에 쿠버네티스 클러스터 배포 스크립트 제공

### 클라우드 관리형 서비스

- **Google Kubernetes Engine (GKE)**: 구글 클라우드의 관리형 쿠버네티스
- **Amazon Elastic Kubernetes Service (EKS)**: AWS의 관리형 쿠버네티스
- **Azure Kubernetes Service (AKS)**: Microsoft Azure의 관리형 쿠버네티스
- **OpenShift Online**: Red Hat의 온라인 쿠버네티스 서비스

## 클러스터 인프라 옵션

### 로컬 머신 옵션

1. **리눅스 기반**:
    - 수동 바이너리 설치 (복잡함)
    - 자동화 도구 사용 (미니큐브, kubeadm 등)
    
2. **윈도우 기반**:
    - 가상화 소프트웨어 필요 (Hyper-V, VMware, VirtualBox)
    - 리눅스 VM 생성 후 쿠버네티스 설치
    - Docker for Windows를 통한 컨테이너 기반 설치 가능 (Hyper-V 사용)

### 로컬 배포 도구

1. **미니큐브 (Minikube)**:
    - 단일 노드 클러스터 배포
    - 가상화 소프트웨어 활용 (VirtualBox 등)
    - 학습 및 개발용으로 적합
    
2. **kubeadm**:
    - 단일 또는 다중 노드 클러스터 배포 가능
    - 사전에 VM 프로비저닝 필요
    - 개발, 테스트, 프로덕션 환경에 모두 사용 가능

### 클라우드 배포 방식

1. **턴키 솔루션**:
    - VM 직접 프로비저닝 후 도구/스크립트로 쿠버네티스 구성
    - VM 유지보수 책임은 사용자에게 있음
    - 예: kOps를 사용한 AWS 배포
    
2. **호스팅 솔루션 (관리형)**:
    - 쿠버네티스-애즈-어-서비스(KaaS) 방식
    - 제공업체가 VM 및 쿠버네티스 구성 관리
    - 예: GKE, EKS, AKS

## 워크로드에 따른 설계

### 스토리지 고려사항

- **고성능 워크로드**: SSD 기반 스토리지 권장
- **다중 동시 접근**: 네트워크 기반 스토리지 고려
- **파드 간 공유 액세스**: 영구 스토리지 볼륨(PV) 사용
- **다양한 요구사항**: 스토리지 클래스 정의 및 적절히 할당

### 노드 유형

- **물리적 머신**: 베어메탈 서버 직접 활용
- **가상 머신**: 클라우드 또는 온프레미스 VM 사용
- **하이브리드**: 물리적 머신과 가상 머신 혼합 사용

## 클러스터 토폴로지

### 기본 구성

- **마스터 노드**: 컨트롤 플레인 컴포넌트 호스팅 (kube-apiserver, etcd, 등)
- **워커 노드**: 실제 워크로드(파드) 호스팅

### 권장 사항

- **프로덕션 환경**: 마스터 노드에 워크로드 배치 지양
    - kubeadm은 기본적으로 마스터 노드에 taint 적용하여 워크로드 배치 방지
- **대규모 클러스터**: etcd 클러스터를 마스터 노드와 분리하여 별도 노드로 구성 고려
- **운영체제**: 64비트 리눅스 운영체제 사용 필수

## 학습용 로컬 클러스터 예시

### VirtualBox 기반 설정

- **노드 구성**: 3개 노드 (1 마스터, 2 워커)
- **가상화 도구**: Oracle VirtualBox
- **배포 방식**: kubeadm 활용한 수동 설정
- **목적**: 학습 및 실습

### 구성 과정

1. VirtualBox에 VM 생성 (리눅스 기반)
2. 각 VM에 필요한 패키지 설치
3. kubeadm을 사용하여 클러스터 초기화
4. 네트워크 애드온 설치
5. 워커 노드 조인

## 요약

- 클러스터 설계는 목적, 워크로드, 인프라에 따라 달라짐
- 학습/개발용은 간단한 로컬 설정으로 충분
- 프로덕션 환경은 고가용성, 확장성, 보안성 고려 필요
- 클라우드 관리형 서비스는 관리 부담을 줄이지만 비용 발생
- 온프레미스 솔루션은 제어력이 높지만 관리 부담 **큼**