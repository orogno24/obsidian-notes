## Nexus Repositoryë€?

**ë©€í‹°í¬ë§· ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ** - ê°œë°œì— í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ íŒŒì¼ì„ ì¤‘ì•™ì—ì„œ ê´€ë¦¬í•˜ëŠ” ë„êµ¬
### ì™œ í•„ìš”í•œê°€?

```
ë¬¸ì œ: ê°œë°œìë“¤ì´ ê°ì ì™¸ë¶€ì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‹¤ìš´ë¡œë“œ
í•´ê²°: ë‚´ë¶€ ì„œë²„ì— ëª¨ì•„ë‘ê³  í•œ ê³³ì—ì„œ ê´€ë¦¬
```
### ê¸°ë³¸ vs Nexus

```yaml
ê¸°ë³¸ ë°©ì‹:
  ê°œë°œì â†’ Maven Central (ì™¸ë¶€) â†’ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‹¤ìš´ë¡œë“œ

Nexus ë°©ì‹:
  ê°œë°œì â†’ Nexus (ë‚´ë¶€) â†’ Maven Central â†’ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‹¤ìš´ë¡œë“œ
          â†‘ ìºì‹œ/ê´€ë¦¬      â†‘ ì²« ë²ˆì§¸ë§Œ
```

## ì£¼ìš” ê¸°ëŠ¥

### 1. **í”„ë¡ì‹œ & ìºì‹±**

- ì™¸ë¶€ ì €ì¥ì†Œ(Maven Central, npm Registry)ì˜ ìºì‹œ ì—­í• 
- í•œ ë²ˆ ë‹¤ìš´ë¡œë“œí•˜ë©´ ë‚´ë¶€ì—ì„œ ì¬ì‚¬ìš©

### 2. **ë©€í‹°í¬ë§· ì§€ì›**

- Docker ì´ë¯¸ì§€
- Maven (Java)
- npm (Node.js)
- PyPI (Python)
- NuGet (.NET)
- Helm ì°¨íŠ¸

### 3. **ì‚¬ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì €ì¥**

- ë‚´ë¶€ì—ì„œ ê°œë°œí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê³µìœ 
- íŒ€ ê°„ ì½”ë“œ ì¬ì‚¬ìš©

## ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### **ê°œì¸/ì†Œê·œëª¨ íŒ€**

```
ì‚¬ìš© ì•ˆí•¨ (95%)
â†’ Maven Central ì§ì ‘ ì‚¬ìš©
â†’ ì„¤ì • ê°„ë‹¨, ë¹„ìš© ì—†ìŒ
```

### **ì¤‘ëŒ€í˜• ê¸°ì—…**

```
ì‚¬ìš©í•¨ (80%)
â†’ ë³´ì•ˆ ì •ì±…, ë§ë¶„ë¦¬ í™˜ê²½
â†’ ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„±, í†µì œ í•„ìš”
```

## ì‹¤ì œ ì„¤ì • ì˜ˆì‹œ

### **Maven ì„¤ì •**

```xml
<!-- pom.xml -->
<project>
    <!-- Repository ì„¤ì •: ì–´ë””ì„œ ê°€ì ¸ì˜¬ì§€ -->
    <repositories>
        <repository>
            <id>nexus</id>
            <url>http://nexus.company.com:8081/repository/maven-public/</url>
        </repository>
    </repositories>
    
    <!-- ì˜ì¡´ì„± ì„ ì–¸: ë¬´ì—‡ì„ ê°€ì ¸ì˜¬ì§€ -->
    <dependencies>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>5.3.21</version>
        </dependency>
    </dependencies>
</project>
```

### ë¹Œë“œ ì‹œ ë™ì‘

```bash
mvn clean compile
â†“
Maven: pom.xmlì—ì„œ ì˜ì¡´ì„± ëª©ë¡ í™•ì¸
â†“  
Maven: "spring-core 5.3.21ì´ í•„ìš”í•˜ë„¤"
â†“
Maven: Repository ì„¤ì • í™•ì¸ â†’ Nexus ì„œë²„ ì ‘ê·¼
â†“
Nexus: spring-core ìˆëŠ”ì§€ í™•ì¸
  - ìˆìœ¼ë©´: ë°”ë¡œ ì „ë‹¬
  - ì—†ìœ¼ë©´: Maven Centralì—ì„œ ë‹¤ìš´ë¡œë“œ í›„ ìºì‹œí•˜ê³  ì „ë‹¬
â†“
ë¹Œë“œ ì™„ë£Œ
```

## ì¥ë‹¨ì 

### **ì¥ì **

- ğŸš€ ë¹ ë¥¸ ë‹¤ìš´ë¡œë“œ (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬)
- ğŸ”’ ë³´ì•ˆ í†µì œ (ìŠ¹ì¸ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ)
- ğŸ“¦ í†µí•© ê´€ë¦¬ (ëª¨ë“  ì•„í‹°íŒ©íŠ¸ í•œ ê³³ì—)
- ğŸ¢ ì‚¬ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê³µìœ 

### **ë‹¨ì **

- ğŸ’° ë¹„ìš© (ì„œë²„, ê´€ë¦¬ ì¸ë ¥)
- âš™ï¸ ì„¤ì • ë³µì¡ì„±
- ğŸ”§ ìœ ì§€ë³´ìˆ˜ í•„ìš”

## ê²½ìŸ ì œí’ˆ ë¹„êµ

|ì œí’ˆ|íŠ¹ì§•|ì‚¬ìš© í™˜ê²½|
|---|---|---|
|**Nexus**|ë©€í‹°í¬ë§·, ê¸°ì—…ê¸‰|ëŒ€ê¸°ì—…, CI/CD ì¤‘ì‹¬|
|**Harbor**|ì»¨í…Œì´ë„ˆ ì „ë¬¸|ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½|
|**Docker Hub**|í¼ë¸”ë¦­ í´ë¼ìš°ë“œ|ê°œì¸, ì†Œê·œëª¨|

## í•µì‹¬ í¬ì¸íŠ¸

```yaml
ì–¸ì œ ì‚¬ìš©?: 
  - ê¸°ì—… í™˜ê²½ (ë³´ì•ˆ ì •ì±…)
  - íŒ€ ê·œëª¨ í¼ (íš¨ìœ¨ì„±)
  - ë§ë¶„ë¦¬ í™˜ê²½ (ì ‘ê·¼ ì œí•œ)
  - ì‚¬ë‚´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê³µìœ 

ì™œ ì‚¬ìš©?:
  - ì˜ì¡´ì„± "ì •ë³´"ëŠ” ì½”ë“œì—, "íŒŒì¼"ì€ ë³„ë„ ê´€ë¦¬
  - ì™¸ë¶€ ì˜ì¡´ì„± ì—†ëŠ” ì•ˆì •ì  ë¹Œë“œ
  - ì¤‘ì•™ì§‘ì¤‘ì‹ ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬
```

**í•œì¤„ ìš”ì•½**: ê°œë°œíŒ€ì˜ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë‚´ë¶€ ì €ì¥ì†Œ

---
# ğŸ“ Nexus Docker Registry ìš´ì˜ ë©”ëª¨

## ğŸ¯ ëª©í‘œ

ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ Nexusë¥¼ Docker ì´ë¯¸ì§€ ì €ì¥ì†Œë¡œ ì‚¬ìš©í•˜ê³ , ê¸°ì¡´ VMì—ì„œ ê´€ë¦¬í•˜ë˜ ì´ë¯¸ì§€ë¥¼ ìƒˆ í™˜ê²½ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì´ì „í•œë‹¤.

## ğŸŸ¢ Nexus ì„¤ì¹˜ êµ¬ì¡°

### âœ… ê¸°ì¡´ VM Nexus

- íšŒì‚¬ì—ì„œ ì§ì ‘ VMì— Nexusë¥¼ ì„¤ì¹˜í•´ ìš´ì˜.
- ì ‘ì† URL:
    ```
    https://14.63.177.157:8443/
    ```
- Repositoryì— ê¸°ì¡´ Docker ì´ë¯¸ì§€ê°€ ì €ì¥ë˜ì–´ ìˆìŒ.
- ëª©ì : **ì´ ì´ë¯¸ì§€ë“¤ì„ íŒŒë“œë¡œ ë°°í¬ëœ Nexusë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜**

---

### âœ… ì¿ ë²„ë„¤í‹°ìŠ¤ Nexus

- Helm Chartë¡œ ì„¤ì¹˜

- ì„œë¹„ìŠ¤ ë…¸ì¶œ ë°©ì‹:

    - NodePort 30018 (HTTP Docker Port)
    - NodePort 30443 (HTTPS Docker Port)
    - ClusterIP 8081 (ì›¹ UI/REST API)

- Ingressë„ ë°°í¬ë˜ì–´ ìˆìœ¼ë‚˜ EXTERNAL-IPëŠ” ì—†ìŒ (NodePortë§Œ ë…¸ì¶œ ì¤‘)

---

## ğŸŸ¢ ë§ˆì´ê·¸ë ˆì´ì…˜ ëª©ì 

- ê¸°ì¡´ VM Nexusì— ì €ì¥ëœ ì´ë¯¸ì§€ ì •ë³´ë¥¼ **ì¿ ë²„ë„¤í‹°ìŠ¤ Nexusë¡œ ì´ì „**.
- ìƒˆ í™˜ê²½ì— ë™ì¼í•œ ì´ë¯¸ì§€ ë„¤ì„ê³¼ íƒœê·¸ë¡œ ì €ì¥.
- ì´í›„ êµ¬ì¶•ëœ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì¼ê´€ë˜ê²Œ Pull ê°€ëŠ¥.

---
### NodePort (HTTPS) ë°©ì‹

- í¬íŠ¸: `30443`
- HTTPS ì¸ì¦ì„œ CN/SAN ì£¼ì˜

- ì˜ˆì‹œ:
    ```bash
    sudo nerdctl tag nginx 172.25.0.84:30443/myimage/nginx:latest
    sudo nerdctl push 172.25.0.84:30443/myimage/nginx:latest
    ```

---

### Ingress Subpath ë°©ì‹

- DNSê°€ Ingressì— ì—°ê²°ë˜ì–´ì•¼ í•¨
- `/etc/hosts`ì— Ingress Node IP ë“±ë¡ í•„ìš”

- ì˜ˆì‹œ `/etc/hosts`:
    ```
    172.25.0.96 repository.dev.eris.go.kr
    ```

- ì˜ˆì‹œ Push:
    ```bash
    sudo nerdctl tag nginx repository.dev.eris.go.kr/my-repo/nginx:latest
    sudo nerdctl push repository.dev.eris.go.kr/my-repo/nginx:latest
    ```
- Repositoryê°€ `my-repo`ë¡œ êµ¬ë¶„ë¨.

---
# ë„¥ì„œìŠ¤ ëª…ë ¹ì–´
## ğŸŸ¢ 1ï¸âƒ£ nerdctl ë¡œê·¸ì¸

```
nerdctl login --insecure-registry 10.100.0.102:32415
```

âœ… í”„ë¡¬í”„íŠ¸ê°€ ë‚˜ì˜¤ë©´ ì…ë ¥:

```
Username: admin
Password: <Nexus ë¹„ë°€ë²ˆí˜¸>
```

---
## ğŸŸ¢ 2ï¸âƒ£ ì´ë¯¸ì§€ íƒœê·¸ ì§€ì •

ì˜ˆë¥¼ ë“¤ì–´ busybox ì´ë¯¸ì§€ë¥¼ íƒœê·¸í•˜ë ¤ë©´:
```
nerdctl tag busybox:latest 10.100.0.102:32415/my-docker-image/busybox:latest
```

> `my-docker-image` = Nexusì— ë§Œë“  Docker hosted repo ì´ë¦„

---

## ğŸŸ¢ 3ï¸âƒ£ ì´ë¯¸ì§€ í‘¸ì‹œ

```
nerdctl --insecure-registry push 10.100.0.102:32415/my-docker-image/busybox:latest
```

---

## ğŸŸ¢ nerdctl Pull

ë…ë¦½ë§ HTTP ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°:
```
nerdctl --insecure-registry pull 10.100.0.102:32415/my-docker-image/busybox:latest
```

âœ… `--insecure-registry` ê¼­ í•„ìš”í•¨ (HTTP ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¼ì„œ)

---
## âœ… Pull ì™„ë£Œ í›„ í™•ì¸

ì´ë¯¸ì§€ê°€ ì˜ ë“¤ì–´ì™”ëŠ”ì§€ í™•ì¸:
```
nerdctl images
```



## Nexus Push, Pull ì˜ˆì‹œ

1ï¸âƒ£ `quay.io/jetstack` ì—ì„œ í•„ìš”í•œ ì´ë¯¸ì§€ë¥¼ **í´ëŸ¬ìŠ¤í„° ë…¸ë“œì— pull**  
2ï¸âƒ£ ë¡œì»¬ì— ì €ì¥ëœ ì´ë¯¸ì§€ë¥¼ **Nexusë¡œ push**  
3ï¸âƒ£ `cert-manager.yaml`ì˜ `image:`ë¥¼ **ë‚´ Nexus ê²½ë¡œë¡œ ë³€ê²½**

### âœ… 1. í•„ìš”í•œ ì´ë¯¸ì§€ Pull

ë¨¼ì € ì›í•˜ëŠ” ë²„ì „ì„ `docker` ë˜ëŠ” `nerdctl`ë¡œ ë‹¤ìš´ë¡œë“œ:

```bash
nerdctl pull quay.io/jetstack/cert-manager-cainjector:v1.14.4
```

âœ… ë‹¤ ë°›ìœ¼ë©´ `nerdctl images` ë¡œ í™•ì¸

---
### âœ… 2. ì´ë¯¸ì§€ì— ìƒˆë¡œìš´ íƒœê·¸ ë‹¬ê¸° (ë‚´ Nexus ê²½ë¡œë¡œ)

ì˜ˆ: Nexusê°€ `10.100.0.102:32415/my-docker-image`ì— ìˆë‹¤ê³  ê°€ì •

```bash
nerdctl tag quay.io/jetstack/cert-manager-cainjector:v1.14.4 \
  10.100.0.102:32415/my-docker-image/cert-manager-cainjector:v1.14.4
```

---
### âœ… 3. Nexusì— Push

Nexus ë¡œê·¸ì¸:

```bash
nerdctl login --insecure-registry 10.100.0.102:32415
```

ì´ë¯¸ì§€ Push:

```bash
nerdctl --insecure-registry push 10.100.0.102:32415/my-docker-image/cert-manager-cainjector:v1.14.4
```

âœ… Nexus UIì—ì„œ ì˜¬ë¼ê°”ëŠ”ì§€ í™•ì¸.

---

### âœ… 4. cert-manager.yamlì˜ ì´ë¯¸ì§€ ê²½ë¡œ ìˆ˜ì •

ê¸°ì¡´:

```yaml
image: "quay.io/jetstack/cert-manager-cainjector:v1.14.4"
```

ë³€ê²½:

```yaml
image: "10.100.0.102:32415/my-docker-image/cert-manager-cainjector:v1.14.4"
```
---
## âœ… 5. Kubernetesì— ì ìš©

ì¸í„°ë„· ëŠì–´ë„ ì´ì œ Nexusì—ì„œ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ:

```bash
kubectl apply -f cert-manager.yaml
```

---

## ğŸ“ ìš”ì•½

âœ… **Pull** â†’ âœ… **Tag** â†’ âœ… **Push** â†’ âœ… **YAML ìˆ˜ì •** â†’ âœ… **ì ìš©**