### Giteaë€?

GiteaëŠ” **Go ì–¸ì–´ë¡œ ì‘ì„±ëœ ê°€ë²¼ìš´ ìì²´ í˜¸ìŠ¤íŒ… Git ì„œë¹„ìŠ¤**ì…ë‹ˆë‹¤. GitHubì´ë‚˜ GitLabê³¼ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ë§Œ, ë‹¨ì¼ ë°”ì´ë„ˆë¦¬ë¡œ ë°°í¬ë˜ì–´ ì„¤ì¹˜ê°€ ê°„í¸í•˜ê³  ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì´ ì ìŠµë‹ˆë‹¤.

### í•µì‹¬ íŠ¹ì§•

- **ê²½ëŸ‰ì„±**: ìµœì†Œí•œì˜ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- **ë‹¨ì¼ ë°”ì´ë„ˆë¦¬**: Go ì–¸ì–´ íŠ¹ì„±ìœ¼ë¡œ ë°°í¬ ê°„í¸
- **ì™„ì „ ì˜¤í”ˆì†ŒìŠ¤**: MIT ë¼ì´ì„ ìŠ¤
- **ìì²´ í˜¸ìŠ¤íŒ…**: ì™„ì „í•œ ë°ì´í„° ì£¼ê¶Œ
- **ë¹ ë¥¸ ì„±ëŠ¥**: Git ì‘ì—…ì— ìµœì í™”
- **ì‹¬í”Œí•œ UI**: í•„ìˆ˜ ê¸°ëŠ¥ ì¤‘ì‹¬ì˜ ì§ê´€ì  ì¸í„°í˜ì´ìŠ¤

### ì í•©í•œ ì‚¬ìš© ì‚¬ë¡€

- **ê¸°ì—… ë‚´ë¶€ ì½”ë“œ ê´€ë¦¬**
- **í”„ë¼ì´ë¹— íŒ€ í”„ë¡œì íŠ¸**
- **ì œí•œëœ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œì˜ ê°œë°œ**
- **ë°ì´í„° ì£¼ê¶Œ/ê·œì œ ìš”êµ¬ì‚¬í•­ì´ ìˆëŠ” ìƒí™©**
- **ë¦¬ì†ŒìŠ¤ê°€ ì œí•œëœ í™˜ê²½** (ë¼ì¦ˆë² ë¦¬ íŒŒì´ ë“±)
- **ê°„ë‹¨í•œ Git ì„œë²„ê°€ í•„ìš”í•œ ê²½ìš°**

---

## âš–ï¸ GitHub vs GitLab vs Gitea ë¹„êµ

### ìƒì„¸ ê¸°ëŠ¥ ë¹„êµ

|í•­ëª©|**GitHub**|**GitLab**|**Gitea**|
|---|---|---|---|
|**ì†Œìœ /ìš´ì˜**|Microsoft (í´ë¼ìš°ë“œ ì¤‘ì‹¬)|GitLab Inc. (ë…ë¦½ ìš´ì˜)|**ì»¤ë®¤ë‹ˆí‹° ê¸°ë°˜ (ë¹„ì˜ë¦¬ì )**|
|**ì„¤ì¹˜í˜• ì§€ì›**|ì œí•œì  (Enterprise Serverë§Œ)|**ì™„ë²½ ì§€ì› (CE/EE)**|**ë§¤ìš° ê°€ë³ê³  ì‰¬ìš´ ì„¤ì¹˜**|
|**CI/CD ë‚´ì¥**|GitHub Actions (ê°•ë ¥)|**GitLab CI/CD (ì™„ì „ í†µí•©)**|ì—†ìŒ (ì™¸ë¶€ ì—°ë™ í•„ìš”)|
|**ì†ë„/ê²½ëŸ‰ì„±**|ë¬´ë‚œí•œ ì„±ëŠ¥|ê¸°ëŠ¥ì´ ë§ì•„ ë¬´ê±°ì›€|**ë§¤ìš° ê°€ë³ê³  ë¹ ë¦„**|
|**UI/UX**|ì§ê´€ì ì´ê³  ì„¸ë ¨ë¨|ê¸°ëŠ¥ ë§ì•„ ë³µì¡í•  ìˆ˜ ìˆìŒ|**ì‹¬í”Œí•œ UI (í•„ìˆ˜ ê¸°ëŠ¥ë§Œ)**|
|**ì˜¤í”ˆì†ŒìŠ¤**|âŒ (ë¶€ë¶„ë§Œ ê³µê°œ)|âœ… (CE ì˜¤í”ˆì†ŒìŠ¤)|âœ… **ì™„ì „ ì˜¤í”ˆì†ŒìŠ¤**|
|**ê¸°ëŠ¥ í™•ì¥ì„±**|Marketplace ì•± ë‹¤ì–‘|**DevOps ê¸°ëŠ¥ ì „ë°˜ ë‚´ì¥**|ì œí•œì , ì™¸ë¶€ í†µí•© ê¶Œì¥|
|**ì ‘ê·¼ì„±**|ì „ ì„¸ê³„ í´ë¼ìš°ë“œ|í´ë¼ìš°ë“œ/ì˜¨í”„ë ˆë¯¸ìŠ¤|**ì˜¨í”„ë ˆë¯¸ìŠ¤ ì „ìš©**|
|**ë³´ì•ˆ ìˆ˜ì¤€**|í´ë¼ìš°ë“œ ì˜ì¡´|ë†’ì€ ë³´ì•ˆ ê¸°ëŠ¥|**ì™„ì „ ê²©ë¦¬ ê°€ëŠ¥**|
|**ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**|í´ë¼ìš°ë“œë¼ ë¬´ê´€|ë†’ìŒ (RAM 4GB+ ê¶Œì¥)|**ë‚®ìŒ (RAM 512MBë„ ê°€ëŠ¥)**|

### ì„ íƒ ê°€ì´ë“œ

#### GitHub ì„ íƒ ì‹œ

- **ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸** ê³µê°œ
- **í˜‘ì—…ê³¼ ì»¤ë®¤ë‹ˆí‹°** ì¤‘ìš”
- **GitHub Actions** í™œìš© ì›í•¨
- **ë¹ ë¥¸ ì‹œì‘**ì´ ìš°ì„ 

#### GitLab ì„ íƒ ì‹œ

- **ì™„ì „í•œ DevOps íŒŒì´í”„ë¼ì¸** í•„ìš”
- **ê¸°ì—…ê¸‰ ê¸°ëŠ¥** ìš”êµ¬
- **ì´ìŠˆ ê´€ë¦¬, í”„ë¡œì íŠ¸ ê´€ë¦¬** í†µí•© í•„ìš”
- **ë³´ì•ˆ ìŠ¤ìº”, ì»´í”Œë¼ì´ì–¸ìŠ¤** ì¤‘ìš”

#### Gitea ì„ íƒ ì‹œ

- **ì™„ì „í•œ í”„ë¼ì´ë¹—** í™˜ê²½ í•„ìš”
- **ê²½ëŸ‰ ì†”ë£¨ì…˜** ì„ í˜¸
- **ë‹¨ìˆœí•œ Git ì„œë²„**ë§Œ í•„ìš”
- **ë¦¬ì†ŒìŠ¤ ì œì•½** í™˜ê²½
- **ë°ì´í„° ì£¼ê¶Œ** í™•ë³´ í•„ìš”

---

## ğŸš€ Gitea ì„¤ì¹˜

### 1. Helmì„ í†µí•œ ì„¤ì¹˜

#### Helm ì €ì¥ì†Œ ì¶”ê°€

```bash
# Gitea Helm ì €ì¥ì†Œ ì¶”ê°€
helm repo add gitea-charts https://dl.gitea.io/charts/

# ì €ì¥ì†Œ ì—…ë°ì´íŠ¸
helm repo update

# Values íŒŒì¼ í™•ì¸ (ì„ íƒì‚¬í•­)
helm show values gitea-charts/gitea > gitea-values.yaml
```

#### Gitea ì„¤ì¹˜

```bash
# ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì„¤ì¹˜
helm install gitea gitea-charts/gitea --namespace op-gitops

# ì»¤ìŠ¤í…€ values ì‚¬ìš© ì‹œ
helm install gitea gitea-charts/gitea --namespace op-gitops -f gitea-values.yaml
```

#### ì„¤ì¹˜ í™•ì¸

```bash
# Pod ìƒíƒœ í™•ì¸
kubectl get pods -n op-gitops

# ì„œë¹„ìŠ¤ í™•ì¸
kubectl get svc -n op-gitops

# Gitea ë¡œê·¸ í™•ì¸
kubectl logs -l app.kubernetes.io/name=gitea -n op-gitops
```

### 2. TLS ì¸ì¦ì„œ ìƒì„±

```bash
# ê°œì¸ í‚¤ ìƒì„±
openssl genrsa -out gitea-tls.key 2048

# ì¸ì¦ì„œ ì„œëª… ìš”ì²­(CSR) ìƒì„±
openssl req -new -key gitea-tls.key -out gitea-tls.csr \
  -subj "/CN=gitea.dev.gcp.go.kr"

# ìì²´ ì„œëª… ì¸ì¦ì„œ ìƒì„±
openssl x509 -req -days 365 -in gitea-tls.csr \
  -signkey gitea-tls.key -out gitea-tls.crt

# Kubernetes Secret ìƒì„±
kubectl create secret tls gitea-tls -n op-gitops \
  --cert=gitea-tls.crt \
  --key=gitea-tls.key
```

### 3. Ingress ì„¤ì •

```yaml
# gitea-ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: gitea-ingress
  namespace: op-gitops
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "1024m"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
spec:
  ingressClassName: nginx
  rules:
  - host: gitea.dev.gcp.go.kr
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: gitea-http
            port:
              number: 3000
  tls:
  - hosts:
    - gitea.dev.gcp.go.kr
    secretName: gitea-tls
```

```bash
kubectl apply -f gitea-ingress.yaml
```

### 4. ì´ˆê¸° ì ‘ì† ë° ì„¤ì •

```bash
# Gitea ì ‘ì† URL
https://gitea.dev.gcp.go.kr:30191/
```

**ì´ˆê¸° ì„¤ì • ê³¼ì •:**

1. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (SQLite/PostgreSQL/MySQL)
2. ê´€ë¦¬ì ê³„ì • ìƒì„±
3. SSH ì„œë²„ ì„¤ì •
4. ë©”ì¼ ì„œë²„ ì„¤ì • (ì„ íƒì‚¬í•­)

---

## ğŸ”‘ ì•¡ì„¸ìŠ¤ í† í° ê´€ë¦¬

### ì•¡ì„¸ìŠ¤ í† í°ì´ í•„ìš”í•œ ì´ìœ 

- **ë³´ì•ˆ ê°•í™”**: ë¹„ë°€ë²ˆí˜¸ë³´ë‹¤ ì•ˆì „
- **ê¶Œí•œ ì„¸ë¶„í™”**: íŠ¹ì • ì‘ì—…ë§Œ í—ˆìš© ê°€ëŠ¥
- **ì·¨ì†Œ ê°€ëŠ¥**: ì–¸ì œë“ ì§€ í† í° ë¬´íš¨í™” ê°€ëŠ¥
- **CI/CD ì—°ë™**: ìë™í™”ëœ ì‹œìŠ¤í…œì—ì„œ ì•ˆì „í•œ ì¸ì¦

### ì•¡ì„¸ìŠ¤ í† í° ìƒì„± ë°©ë²•

#### 1. Gitea UIì—ì„œ ìƒì„±

```
Gitea ë¡œê·¸ì¸ â†’ ìš°ì¸¡ ìƒë‹¨ í”„ë¡œí•„ â†’ ì„¤ì •(Settings) â†’ ì• í”Œë¦¬ì¼€ì´ì…˜(Applications)
```

#### 2. ìƒˆ í† í° ìƒì„±

- **í† í° ì´ë¦„**: ìš©ë„ë³„ êµ¬ë¶„ (ì˜ˆ: `jenkins-ci`, `argocd-sync`)
- **ë§Œë£Œ ì‹œê°„**: ë³´ì•ˆ ì •ì±…ì— ë”°ë¼ ì„¤ì •
- **ê¶Œí•œ ì„¤ì •**:
    - **Repository Access**: "All (public, private, and limited)"
    - **Specific Permissions**:
        - `repository`: "Read and Write" (í•„ìˆ˜)
        - `organization`: "Read" (ì¡°ì§ ì €ì¥ì†Œ ì‚¬ìš© ì‹œ)
        - `package`: "Read" (íŒ¨í‚¤ì§€ ì‚¬ìš© ì‹œ)

#### 3. í† í° ë³´ì•ˆ ê´€ë¦¬

```bash
# ìƒì„±ëœ í† í° ì˜ˆì‹œ
ghp_1234567890abcdefghijklmnopqrstuvwxyz

# Kubernetes Secretìœ¼ë¡œ ì €ì¥
kubectl create secret generic gitea-token \
  --from-literal=token=ghp_1234567890abcdefghijklmnopqrstuvwxyz \
  -n op-gitops

# Jenkins Credentialsë¡œ ì €ì¥
# Dashboard â†’ Manage Jenkins â†’ Credentials â†’ Add Credentials
# Kind: Secret text
# Secret: <í† í° ê°’>
# ID: gitea-token
```

### í† í° ì‚¬ìš© ì˜ˆì‹œ

#### Git í´ë¡  ì‹œ í† í° ì‚¬ìš©

```bash
# HTTPS í´ë¡ ì—ì„œ í† í° ì‚¬ìš©
git clone https://<username>:<token>@gitea.dev.gcp.go.kr/user/repo.git

# ë˜ëŠ” Git credential helper ì„¤ì •
git config --global credential.helper store
# ì´í›„ ì²« í‘¸ì‹œ/í’€ ì‹œ usernameê³¼ token ì…ë ¥
```

#### Jenkinsì—ì„œ í† í° ì‚¬ìš©

```groovy
// Jenkinsfileì—ì„œ Git ì²´í¬ì•„ì›ƒ
checkout([
    $class: 'GitSCM',
    userRemoteConfigs: [[
        url: 'https://gitea.dev.gcp.go.kr/user/repo.git',
        credentialsId: 'gitea-token'
    ]],
    branches: [[name: 'main']]
])
```

---

## ğŸ’» Git ì‘ì—… ì ˆì°¨

### ìƒˆ í”„ë¡œì íŠ¸ ì‹œì‘í•˜ê¸°

#### 1. ë¡œì»¬ Git ì €ì¥ì†Œ ì´ˆê¸°í™”

```bash
# í”„ë¡œì íŠ¸ í´ë”ì—ì„œ Git Bash ì‹¤í–‰
cd /path/to/your/project

# Git ì €ì¥ì†Œ ì´ˆê¸°í™”
git init

# ì‚¬ìš©ì ì •ë³´ ì„¤ì • (ìµœì´ˆ 1íšŒ)
git config --global user.name "Your Name"
git config --global user.email "your.email@company.com"
```

#### 2. Giteaì—ì„œ ì €ì¥ì†Œ ìƒì„±

```
Gitea UI â†’ New Repository â†’ ì €ì¥ì†Œ ì´ë¦„ ì…ë ¥ â†’ Create Repository
```

#### 3. ì›ê²© ì €ì¥ì†Œ ì—°ê²°

```bash
# ì›ê²© ì €ì¥ì†Œ ì¶”ê°€
git remote add origin https://gitea.dev.gcp.go.kr:30191/username/repository.git

# ì›ê²© ì €ì¥ì†Œ í™•ì¸
git remote -v
```

#### 4. ì´ˆê¸° ì»¤ë°‹ ë° í‘¸ì‹œ

```bash
# íŒŒì¼ ìŠ¤í…Œì´ì§•
git add .

# ì´ˆê¸° ì»¤ë°‹
git commit -m "Initial commit"

# ê¸°ë³¸ ë¸Œëœì¹˜ë¥¼ mainìœ¼ë¡œ ì„¤ì • (ì„ íƒì‚¬í•­)
git branch -M main

# ì›ê²© ì €ì¥ì†Œì— í‘¸ì‹œ
git push -u origin main
```

### ê¸°ì¡´ ì €ì¥ì†Œ ì‘ì—…í•˜ê¸°

#### ì¼ë°˜ì ì¸ Git ì›Œí¬í”Œë¡œìš°

```bash
# 1. ìµœì‹  ë³€ê²½ì‚¬í•­ ê°€ì ¸ì˜¤ê¸°
git pull origin main

# 2. ìƒˆ ë¸Œëœì¹˜ ìƒì„± (ê¸°ëŠ¥ ê°œë°œ ì‹œ)
git checkout -b feature/new-feature

# 3. íŒŒì¼ ìˆ˜ì • í›„ ë³€ê²½ì‚¬í•­ í™•ì¸
git status
git diff

# 4. ë³€ê²½ì‚¬í•­ ìŠ¤í…Œì´ì§•
git add .
# ë˜ëŠ” íŠ¹ì • íŒŒì¼ë§Œ
git add filename.txt

# 5. ì»¤ë°‹
git commit -m "Add new feature: description"

# 6. ì›ê²© ì €ì¥ì†Œì— í‘¸ì‹œ
git push origin feature/new-feature

# 7. Gitea UIì—ì„œ Pull Request ìƒì„±
```

#### ì›ê²© ì €ì¥ì†Œì™€ ì¶©ëŒ í•´ê²°

```bash
# ì›ê²© ì €ì¥ì†Œì— ì´ë¯¸ ì»¤ë°‹ì´ ìˆëŠ” ê²½ìš°
git pull origin main --allow-unrelated-histories

# ì¶©ëŒ ë°œìƒ ì‹œ ìˆ˜ë™ í•´ê²° í›„
git add .
git commit -m "Merge conflict resolved"

# ìµœì¢… í‘¸ì‹œ
git push -u origin main
```

### Git ì„¤ì • ìµœì í™”

#### ìœ ìš©í•œ Git ì„¤ì •

```bash
# ê¸°ë³¸ ì—ë””í„° ì„¤ì •
git config --global core.editor "code --wait"  # VS Code ì‚¬ìš© ì‹œ

# ì¤„ë°”ê¿ˆ ì„¤ì • (Windows)
git config --global core.autocrlf true

# ì¤„ë°”ê¿ˆ ì„¤ì • (Linux/Mac)
git config --global core.autocrlf input

# Pull ì „ëµ ì„¤ì •
git config --global pull.rebase false

# ê¸°ë³¸ ë¸Œëœì¹˜ëª… ì„¤ì •
git config --global init.defaultBranch main
```

#### .gitignore í…œí”Œë¦¿

```bash
# .gitignore ì˜ˆì‹œ (Java í”„ë¡œì íŠ¸)
*.class
*.jar
*.war
target/
.gradle/
build/
.idea/
*.iml
.vscode/
.DS_Store
```

---

## ğŸ‘¥ ì €ì¥ì†Œ ê¶Œí•œ ê´€ë¦¬

### 1. í˜‘ì—…ì ê´€ë¦¬

#### ì‚¬ìš©ì ì¶”ê°€

```
ì €ì¥ì†Œ â†’ Settings â†’ Collaborators â†’ Add Collaborator
```

**ê¶Œí•œ ë ˆë²¨:**

- **Read**: ì½”ë“œ ì½ê¸°, ì´ìŠˆ ìƒì„±
- **Write**: ì½”ë“œ ì½ê¸°/ì“°ê¸°, ë¸Œëœì¹˜ ìƒì„±
- **Admin**: ëª¨ë“  ê¶Œí•œ + ì €ì¥ì†Œ ì„¤ì •

#### íŒ€ ê¸°ë°˜ ê¶Œí•œ ê´€ë¦¬

```
Organization â†’ Teams â†’ Create Team â†’ íŒ€ì— ì €ì¥ì†Œ í• ë‹¹
```

### 2. ë¸Œëœì¹˜ ë³´í˜¸ ê·œì¹™

#### ë³´í˜¸ ê·œì¹™ ì„¤ì •

```
ì €ì¥ì†Œ â†’ Settings â†’ Branches â†’ Add Rule
```

**ì£¼ìš” ì„¤ì • ì˜µì…˜:**

- **ë¸Œëœì¹˜ íŒ¨í„´**: `main`, `develop`, `release/*`
- **ì§ì ‘ í‘¸ì‹œ ê¸ˆì§€**: âœ… ì²´í¬
- **ë³‘í•© ì „ ê²€í†  ìš”êµ¬**: âœ… ì²´í¬ (Pull Request í•„ìˆ˜)
- **ìƒíƒœ ì²´í¬ ìš”êµ¬**: CI/CD ì„±ê³µ ì‹œì—ë§Œ ë³‘í•©
- **ìµœì‹  ìƒíƒœ ìš”êµ¬**: ë³‘í•© ì „ ìµœì‹  ì»¤ë°‹ í•„ìš”

#### ë¸Œëœì¹˜ ì „ëµ ì˜ˆì‹œ

```bash
# Git Flow ë°©ì‹
main       (í”„ë¡œë•ì…˜)
develop    (ê°œë°œ í†µí•©)
feature/*  (ê¸°ëŠ¥ ê°œë°œ)
release/*  (ë¦´ë¦¬ìŠ¤ ì¤€ë¹„)
hotfix/*   (ê¸´ê¸‰ ìˆ˜ì •)
```

### 3. ì›¹í›… ì„¤ì •

#### ArgoCD ìë™ ë™ê¸°í™” ì›¹í›…

```
ì €ì¥ì†Œ â†’ Settings â†’ Webhooks â†’ Add Webhook
```

**ì›¹í›… ì„¤ì •:**

- **Payload URL**: `https://argocd.example.com/api/webhook`
- **Content Type**: `application/json`
- **Secret**: ArgoCD ì›¹í›… ì‹œí¬ë¦¿
- **Trigger Events**:
    - âœ… Push events
    - âœ… Pull request events

#### Jenkins ë¹Œë“œ íŠ¸ë¦¬ê±° ì›¹í›…

```
ì €ì¥ì†Œ â†’ Settings â†’ Webhooks â†’ Add Webhook
```

**ì›¹í›… ì„¤ì •:**

- **Payload URL**: `https://jenkins.example.com/gitea-webhook/post`
- **Content Type**: `application/json`
- **Trigger Events**: âœ… Push events

---

## ğŸ”„ CI/CD ì—°ë™

### Jenkins ì—°ë™

#### 1. Jenkinsì—ì„œ Gitea ì„¤ì •

```groovy
// Jenkinsfile ì˜ˆì‹œ
pipeline {
    agent any
    
    triggers {
        gitea(
            triggerOnPush: true,
            triggerOnMergeRequest: true,
            branchFilterType: 'All'
        )
    }
    
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }
        
        stage('Build') {
            steps {
                sh './gradlew build'
            }
        }
        
        stage('Test') {
            steps {
                sh './gradlew test'
                publishTestResults testResultsPattern: '**/build/test-results/test/*.xml'
            }
        }
    }
}
```

#### 2. Gitea í”ŒëŸ¬ê·¸ì¸ ì„¤ì •

```
Jenkins â†’ Manage Jenkins â†’ Configure System â†’ Gitea Servers
```

### ArgoCD ì—°ë™

#### 1. ArgoCDì—ì„œ Git ì €ì¥ì†Œ ë“±ë¡

```yaml
# argocd-repository.yaml
apiVersion: v1
kind: Secret
metadata:
  name: gitea-repo
  namespace: argocd
  labels:
    argocd.argoproj.io/secret-type: repository
type: Opaque
stringData:
  type: git
  url: https://gitea.dev.gcp.go.kr/user/manifests.git
  username: your-username
  password: your-access-token
```

#### 2. ArgoCD ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±

```yaml
# argocd-application.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: my-app
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://gitea.dev.gcp.go.kr/user/manifests.git
    targetRevision: main
    path: k8s/
  destination:
    server: https://kubernetes.default.svc
    namespace: default
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

### GitHub Actions ëŒ€ì•ˆ (ì™¸ë¶€ CI/CD)

#### Drone CI ì—°ë™

```yaml
# .drone.yml
kind: pipeline
type: docker
name: default

steps:
- name: build
  image: gradle:jdk11
  commands:
  - gradle build

- name: test  
  image: gradle:jdk11
  commands:
  - gradle test

trigger:
  branch:
  - main
```

---

## ğŸ“‹ í™œìš© ì‹œë‚˜ë¦¬ì˜¤

### ì „ì²´ DevOps íŒŒì´í”„ë¼ì¸ êµ¬ì„±

#### 1. ì´ˆê¸° ì„¤ì •

```bash
# Gitea ê´€ë¦¬ì ê³„ì • ì„¤ì •
# ìƒ˜í”Œ ì €ì¥ì†Œ ìƒì„± (ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ)
# ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì €ì¥ì†Œ ìƒì„± (Kubernetes YAML)
```

#### 2. Jenkins íŒŒì´í”„ë¼ì¸ ì„¤ì •

```groovy
// ì†ŒìŠ¤ ì½”ë“œ ë¹Œë“œ â†’ í…ŒìŠ¤íŠ¸ â†’ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ìƒì„± â†’ Harbor í‘¸ì‹œ
pipeline {
    agent any
    
    environment {
        HARBOR_REGISTRY = 'harbor.example.com'
        IMAGE_NAME = 'my-app'
        IMAGE_TAG = "${BUILD_NUMBER}"
    }
    
    stages {
        stage('Checkout') {
            steps {
                git url: 'https://gitea.dev.gcp.go.kr/user/app.git',
                    credentialsId: 'gitea-token'
            }
        }
        
        stage('Build & Test') {
            steps {
                sh './gradlew clean build test'
            }
        }
        
        stage('Docker Build') {
            steps {
                script {
                    def image = docker.build("${HARBOR_REGISTRY}/${IMAGE_NAME}:${IMAGE_TAG}")
                    docker.withRegistry("https://${HARBOR_REGISTRY}", 'harbor-credentials') {
                        image.push()
                        image.push('latest')
                    }
                }
            }
        }
        
        stage('Update Manifests') {
            steps {
                // GitOps: ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì €ì¥ì†Œ ì—…ë°ì´íŠ¸
                sh """
                git clone https://gitea.dev.gcp.go.kr/user/manifests.git
                cd manifests
                sed -i 's|image: .*|image: ${HARBOR_REGISTRY}/${IMAGE_NAME}:${IMAGE_TAG}|' k8s/deployment.yaml
                git add .
                git commit -m 'Update image to ${IMAGE_TAG}'
                git push
                """
            }
        }
    }
}
```

#### 3. ArgoCD ìë™ ë°°í¬ ì„¤ì •

```yaml
# ArgoCDê°€ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì €ì¥ì†Œë¥¼ ëª¨ë‹ˆí„°ë§í•˜ì—¬ ìë™ ë°°í¬
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: my-application
spec:
  source:
    repoURL: https://gitea.dev.gcp.go.kr/user/manifests.git
    path: k8s/
    targetRevision: main
  destination:
    server: https://kubernetes.default.svc
    namespace: production
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

### íŒ€ í˜‘ì—… ì›Œí¬í”Œë¡œìš°

#### 1. ê¸°ëŠ¥ ê°œë°œ í”Œë¡œìš°

```bash
# 1. ê°œë°œìê°€ ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±
git checkout -b feature/user-authentication

# 2. ì½”ë“œ ì‘ì„± ë° ì»¤ë°‹
git add .
git commit -m "Add user authentication feature"

# 3. Giteaì— í‘¸ì‹œ
git push origin feature/user-authentication

# 4. Gitea UIì—ì„œ Pull Request ìƒì„±
# 5. ì½”ë“œ ë¦¬ë·° ì§„í–‰
# 6. CI/CD íŒŒì´í”„ë¼ì¸ ìë™ ì‹¤í–‰ (Jenkins)
# 7. í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ main ë¸Œëœì¹˜ì— ë³‘í•©
# 8. ArgoCDê°€ ìë™ìœ¼ë¡œ í”„ë¡œë•ì…˜ ë°°í¬
```

#### 2. í•«í”½ìŠ¤ í”Œë¡œìš°

```bash
# 1. ê¸´ê¸‰ ìˆ˜ì • ë¸Œëœì¹˜ ìƒì„±
git checkout -b hotfix/security-patch

# 2. ìˆ˜ì • ë° í…ŒìŠ¤íŠ¸
git commit -m "Fix security vulnerability"

# 3. ë¹ ë¥¸ ë¦¬ë·° ë° ë³‘í•©
# 4. ìë™ ë°°í¬ í™•ì¸
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. Git í‘¸ì‹œ ì¸ì¦ ì‹¤íŒ¨

**ì¦ìƒ**: `authentication failed` ì˜¤ë¥˜

**í•´ê²°ì±…**:

```bash
# 1. ì•¡ì„¸ìŠ¤ í† í° ì¬ìƒì„±
# 2. Git credential ì—…ë°ì´íŠ¸
git config --global credential.helper store
# ë‹¤ì‹œ í‘¸ì‹œí•  ë•Œ usernameê³¼ ìƒˆ í† í° ì…ë ¥

# 3. ë˜ëŠ” URLì— í† í° í¬í•¨
git remote set-url origin https://<username>:<token>@gitea.dev.gcp.go.kr/user/repo.git
```

#### 2. Gitea Pod ì‹œì‘ ì‹¤íŒ¨

**ì¦ìƒ**: Gitea Podê°€ CrashLoopBackOff ìƒíƒœ

**ì§„ë‹¨ ë° í•´ê²°**:

```bash
# ë¡œê·¸ í™•ì¸
kubectl logs -l app.kubernetes.io/name=gitea -n op-gitops

# ë³¼ë¥¨ ë§ˆìš´íŠ¸ ë¬¸ì œ í™•ì¸
kubectl describe pod -l app.kubernetes.io/name=gitea -n op-gitops

# PVC ìƒíƒœ í™•ì¸
kubectl get pvc -n op-gitops

# ì¬ì‹œì‘
kubectl rollout restart deployment/gitea -n op-gitops
```

#### 3. ì›¹í›…ì´ ì‘ë™í•˜ì§€ ì•ŠìŒ

**ì¦ìƒ**: ì½”ë“œ í‘¸ì‹œ í›„ Jenkins/ArgoCDê°€ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠìŒ

**í•´ê²°ì±…**:

```bash
# 1. ì›¹í›… URL í™•ì¸
# 2. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
curl -X POST https://jenkins.example.com/gitea-webhook/post

# 3. ì›¹í›… ë¡œê·¸ í™•ì¸ (Gitea UI)
# Settings â†’ Webhooks â†’ Recent Deliveries

# 4. ë°©í™”ë²½/ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸
```

#### 4. HTTPS ì¸ì¦ì„œ ë¬¸ì œ

**ì¦ìƒ**: ë¸Œë¼ìš°ì €ì—ì„œ ì¸ì¦ì„œ ê²½ê³ 

**í•´ê²°ì±…**:

```bash
# 1. ì¸ì¦ì„œ ì¬ìƒì„±
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout gitea-tls.key -out gitea-tls.crt \
  -subj "/CN=gitea.dev.gcp.go.kr"

# 2. Secret ì—…ë°ì´íŠ¸
kubectl create secret tls gitea-tls -n op-gitops \
  --cert=gitea-tls.crt \
  --key=gitea-tls.key \
  --dry-run=client -o yaml | kubectl apply -f -

# 3. Ingress ì¬ì‹œì‘
kubectl rollout restart deployment/nginx-ingress-controller -n ingress-nginx
```

### ì„±ëŠ¥ ìµœì í™”

#### Git ì €ì¥ì†Œ ìµœì í™”

```bash
# ëŒ€ìš©ëŸ‰ ì €ì¥ì†Œ ì •ë¦¬
git gc --aggressive --prune=now

# ë¶ˆí•„ìš”í•œ ë¸Œëœì¹˜ ì •ë¦¬
git branch -d old-feature-branch
git push origin --delete old-feature-branch
```

#### Gitea ì„±ëŠ¥ íŠœë‹

```yaml
# gitea-values.yaml
gitea:
  config:
    cache:
      ENABLED: true
      ADAPTER: memory
      INTERVAL: 60
    session:
      PROVIDER: memory
    queue:
      TYPE: channel
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Gitea ê³µì‹ ë¬¸ì„œ](https://docs.gitea.io/)
- [Gitea Helm Chart](https://gitea.com/gitea/helm-chart)
- [Git ê³µì‹ ë¬¸ì„œ](https://git-scm.com/doc)
- [GitOps with ArgoCD](https://argo-cd.readthedocs.io/)
- [Jenkins Git Plugin](https://plugins.jenkins.io/git/)

---

**Tags:** #gitea #git #selfhosted #kubernetes #cicd #argocd #jenkins #golang #version-control